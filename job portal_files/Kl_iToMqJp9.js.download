;/*FB_PKG_DELIM*/

__d("WAWebSingleCallDropdownContent.react",["fbt","WAWebActionMenuItem.react","WAWebAddUserIcon.react","WAWebCalendarFilledRefreshedIcon.react","WAWebCallCollection","WAWebCallDropdownMenuItems.react","WAWebContactImage.react","WAWebEnvironment","WAWebFlex.react","WAWebFrontendChatGetters","WAWebFrontendContactGetters","WAWebLinkRefreshedIcon.react","WAWebModalManager","WAWebText.react","WAWebUISpacing","WAWebUserSubtitle.react","WAWebVoipCallsTabScheduleCallModal.react","WAWebVoipCreateCallLinksPopupLoadable.react","WAWebVoipNewGroupCallContactPicker.react","WAWebWamEnumSubSurface","WDSIconIcCallFilled.react","WDSIconIcVideocamFilled.react","react"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=u||(u=r("react")),d=(e||(e=o("react"))).useEffect,m={dropdownContainer:{width:"xj6ak53",overflowX:"x6ikm8r",overflowY:"x10wlt62",$$css:!0},contactTextContainer:{minWidth:"xeuugli",overflowX:"x6ikm8r",overflowY:"x10wlt62",$$css:!0},callButtonsRow:{width:"xh8yej3",rowGap:"x1qvou4u",columnGap:"x1s70e7g",marginTop:"x1380le5",marginBottom:"xat24cr",$$css:!0},callButtonWrapper:{flex:"x1cqoux5",minWidth:"xeuugli",$$css:!0},callButtonMenuItemIcon:{color:"x1pse0pq",height:"xxk0z11",width:"xvy4d1p",$$css:!0},actionsContainer:{width:"xh8yej3",$$css:!0},actionItemIcon:{color:"xhslqc4",$$css:!0}};function p(e){var t,n=e.chat,a=e.enableWebGroupCalling,i=e.handleCall,l=e.isCallingDisabled,u=e.logger,p=e.onActionTaken,_=e.onClose,f=n.contact,g=o("WAWebFrontendContactGetters").getFormattedUser(f),h=o("WAWebFrontendChatGetters").getPresence(n);return d(function(){var e=r("WAWebCallCollection").activeCall;e!=null&&e.shouldShowPostCallSurvey===!0&&r("WAWebCallCollection").setActiveCall(null),u.clickCallDropdown(o("WAWebWamEnumSubSurface").SUB_SURFACE.CHAT_HEADER)},[u]),c.jsxs((t=o("WAWebFlex.react")).FlexColumn,{xstyle:[o("WAWebUISpacing").uiPadding.all8,m.dropdownContainer],grow:1,gap:8,children:[c.jsxs(t.FlexRow,{align:"center",children:[c.jsx(r("WAWebContactImage.react"),{contact:f,size:40,loadPicture:!0}),c.jsxs(t.FlexColumn,{xstyle:[o("WAWebUISpacing").uiPadding.start12,m.contactTextContainer],grow:1,children:[c.jsx(t.FlexItem,{children:c.jsx(o("WAWebText.react").WAWebTextTitle,{textWrap:"ellipsis",children:g})}),c.jsx(t.FlexItem,{children:c.jsx(r("WAWebUserSubtitle.react"),{contact:f,presence:h,chatstate:h.chatstate,location:"title",chatId:n.id})})]})]}),c.jsxs(t.FlexRow,{xstyle:m.callButtonsRow,children:[c.jsx(t.FlexItem,{grow:1,xstyle:m.callButtonWrapper,children:c.jsx(o("WAWebCallDropdownMenuItems.react").CallButtonMenuItem,{optionId:"voice-call",testid:void 0,icon:c.jsx(r("WDSIconIcCallFilled.react"),{iconXstyle:m.callButtonMenuItemIcon}),disabled:l,label:s._(/*BTDS*/"Voice"),onSelect:function(){u.clickAudioCall(o("WAWebWamEnumSubSurface").SUB_SURFACE.CALL_DROPDOWN_MENU),p(),i(!1),_()}})}),c.jsx(o("WAWebFlex.react").FlexItem,{grow:1,xstyle:m.callButtonWrapper,children:c.jsx(o("WAWebCallDropdownMenuItems.react").CallButtonMenuItem,{optionId:"video-call",testid:void 0,icon:c.jsx(r("WDSIconIcVideocamFilled.react"),{iconXstyle:m.callButtonMenuItemIcon}),disabled:l,label:s._(/*BTDS*/"Video"),onSelect:function(){u.clickVideoCall(o("WAWebWamEnumSubSurface").SUB_SURFACE.CALL_DROPDOWN_MENU),p(),i(!0),_()}})})]}),(!r("WAWebEnvironment").isWeb||a)&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"xjm9jq1 x3x0x6p xh8yej3 xav9cv8 x4tpdpg"}),c.jsxs(o("WAWebFlex.react").FlexColumn,{xstyle:m.actionsContainer,children:[c.jsx(o("WAWebActionMenuItem.react").ActionMenuItem,{optionId:"new-group-call",detailLeft:c.jsx(o("WAWebAddUserIcon.react").AddUserIcon,{xstyle:m.actionItemIcon}),primary:c.jsx(o("WAWebText.react").WAWebTextTitle,{color:"secondary",children:s._(/*BTDS*/"New group call")}),onSelect:function(){p(),u.clickAddContact(o("WAWebWamEnumSubSurface").SUB_SURFACE.CALL_DROPDOWN_MENU),o("WAWebModalManager").ModalManager.open(c.jsx(r("WAWebVoipNewGroupCallContactPicker.react"),{chat:n,showCallTypeButtons:!0})),_()}}),c.jsx(o("WAWebActionMenuItem.react").ActionMenuItem,{optionId:"send-call-link",detailLeft:c.jsx(o("WAWebLinkRefreshedIcon.react").LinkRefreshedIcon,{xstyle:m.actionItemIcon}),primary:c.jsx(o("WAWebText.react").WAWebTextTitle,{color:"secondary",children:s._(/*BTDS*/"Send call link")}),onSelect:function(){p(),u.clickCreateVideoCallLinkChatThread(o("WAWebWamEnumSubSurface").SUB_SURFACE.CALL_DROPDOWN_MENU),o("WAWebModalManager").ModalManager.open(c.jsx(o("WAWebVoipCreateCallLinksPopupLoadable.react").WAWebVoipCreateCallLinksPopupLoadable,{targetChat:n})),_()}}),c.jsx(o("WAWebActionMenuItem.react").ActionMenuItem,{optionId:"schedule-call",detailLeft:c.jsx(o("WAWebCalendarFilledRefreshedIcon.react").CalendarFilledRefreshedIcon,{xstyle:m.actionItemIcon}),primary:c.jsx(o("WAWebText.react").WAWebTextTitle,{color:"secondary",children:s._(/*BTDS*/"Schedule call")}),onSelect:function(){p(),u.clickCreateEventChatThread(o("WAWebWamEnumSubSurface").SUB_SURFACE.CALL_DROPDOWN_MENU),o("WAWebVoipCallsTabScheduleCallModal.react").handleScheduleCallForChat(n),_()}})]})]})]})}p.displayName=p.name+" [from "+i.id+"]",l.default=p}),226);
__d("WAWebVoipBetaCallingUpsellPopover.react",["fbt","WAWebFlex.react","WAWebText.react","WAWebUISpacing","WDSButton.react","react"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=r("react")),c={container:{minWidth:"x1h80ny7",$$css:!0},textContainer:{maxWidth:"x1jkqq1h",$$css:!0},buttonContainer:{height:"x5yr21d",$$css:!0}};function d(e){var t,n,a=e.onClick;return u.jsxs((t=o("WAWebFlex.react")).FlexRow,{xstyle:[c.container,(n=o("WAWebUISpacing")).uiPadding.horiz20,n.uiPadding.bottom14,n.uiPadding.top12],align:"center",justify:"all",children:[u.jsxs(t.FlexColumn,{xstyle:c.textContainer,children:[u.jsx(t.FlexItem,{children:u.jsx(o("WAWebText.react").WAWebTextTitle,{children:s._(/*BTDS*/"Try new one-on-one web calling")})}),u.jsx(t.FlexItem,{xstyle:n.uiMargin.top2,children:u.jsx(o("WAWebText.react").WAWebTextMuted,{children:s._(/*BTDS*/"Join the WhatsApp Beta program to start making calls on web. Note: testing version may be unstable")})})]}),u.jsx(t.FlexColumn,{xstyle:c.buttonContainer,align:"center",justify:"center",children:u.jsx(t.FlexItem,{xstyle:n.uiMargin.start16,children:u.jsx(r("WDSButton.react"),{variant:"filled",size:"medium",label:s._(/*BTDS*/"Switch to beta"),onPress:a})})})]})}d.displayName=d.name+" [from "+i.id+"]",l.default=d}),226);
__d("WAWebVoipCallingNux.react",["fbt","WAWebBox.react","WAWebClickable.react","WAWebDropdownV2.react","WAWebFbtCommon","WAWebFlex.react","WAWebNux","WAWebPopoverContext.react","WAWebTooltip.react","WDSIconIcClose.react","WDSText.react","react","useWAWebNux"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e.useEffect,d={row:{minHeight:"xu0aao5",$$css:!0},tooltip:{paddingTop:"x1xrf6ya",paddingInlineEnd:"xde1mab",paddingBottom:"xscbp6u",paddingInlineStart:"x1iw51ew",borderStartStartRadius:"xlr9sxt",borderStartEndRadius:"xvvg52n",borderEndEndRadius:"xwd4zgb",borderEndStartRadius:"xq8v1ta",$$css:!0},arrow:{marginTop:"xdj266r",marginInlineEnd:"x14z9mp",marginBottom:"xat24cr",marginInlineStart:"x1sbwfh8",$$css:!0},button:{borderStartStartRadius:"xt8t1vi",borderStartEndRadius:"x1xc408v",borderEndEndRadius:"x129tdwq",borderEndStartRadius:"x15urzxu",$$css:!0},content:{rowGap:"x1b73lln",columnGap:"x46w9ns",$$css:!0},closeButton:{marginInlineStart:"x150mmf0",$$css:!0}};function m(e){var t=e.nuxKey,n=e.targetRef,a=r("useWAWebNux")(t),i=a[0],l=a[2],m=o("WAWebPopoverContext.react").useWAWebPopoverControllerRef();c(function(){if(i&&n.current!=null){var e;(e=m.current)==null||e.showPopover()}},[i,m,n]);var p=function(){var e;l(),(e=m.current)==null||e.hidePopover()};if(!i)return null;var _=t===o("WAWebNux").NUX.WEB_CALLING_1_1_NUX?s._(/*BTDS*/"One-on-one web calls"):s._(/*BTDS*/"Calling on web"),f=s._(/*BTDS*/"Talk live over audio or video");return u.jsx(r("WAWebBox.react"),{testid:void 0,children:u.jsx(o("WAWebPopoverContext.react").WAWebPopoverController,{targetRef:n,controllerRef:m,popover:u.jsx(o("WAWebTooltip.react").WAWebControllableTooltip,{target:"context",alignment:o("WAWebDropdownV2.react").PopoverAlignment.Center,position:o("WAWebDropdownV2.react").PopoverPosition.Bottom,enableEnterTransition:!0,tooltipXStyle:d.tooltip,arrowXStyle:d.arrow,includeArrow:!0,element:u.jsxs(o("WAWebFlex.react").FlexRow,{xstyle:d.row,align:"center",justify:"all",children:[u.jsxs(o("WAWebFlex.react").FlexColumn,{xstyle:d.content,children:[u.jsx(r("WDSText.react"),{type:"Body2Emphasized",colorName:"contentInverse",children:_}),u.jsx(r("WDSText.react"),{type:"Body3",colorName:"contentInverse",children:f})]}),u.jsx(o("WAWebClickable.react").Clickable,{as:"button",onClick:p,xstyle:[d.button,d.closeButton],ariaLabel:r("WAWebFbtCommon")("Close"),children:u.jsx(r("WDSIconIcClose.react"),{colorName:"contentInverse",width:20,height:20})})]})})})})}m.displayName=m.name+" [from "+i.id+"]",l.default=m}),226);
__d("WAWebVoipCoexCallingPermissionDisabledModal.react",["fbt","WAWebConfirmPopup.react","WAWebModalManager","react"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=r("react"));function c(){var e=function(){o("WAWebModalManager").ModalManager.close()};return u.jsx(o("WAWebConfirmPopup.react").ConfirmPopup,{title:s._(/*BTDS*/"You can't call this customer right now"),onOK:e,okText:s._(/*BTDS*/"OK"),testid:void 0,children:s._(/*BTDS*/"They declined your call request. You can still message or accept calls from them.")})}c.displayName=c.name+" [from "+i.id+"]",l.default=c}),226);
__d("useWAWebVoipIsCallingEnabledAndInited",["WAWebCmd","WAWebVoipBackendLoadable","WAWebVoipGatingUtils","WAWebVoipInit","asyncToGeneratorRuntime","react","useWAWebEventTargetValue","useWAWebListener","useWAWebStableCallback"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e||(e=o("react"))).useEffect;function u(){var e=r("useWAWebStableCallback")(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(o("WAWebVoipGatingUtils").isCallingEnabled()&&!o("WAWebVoipInit").VoipInitEventEmitter.getIsVoipInited()){var e=yield o("WAWebVoipBackendLoadable").requireVoipJsBackend(),t=e.WAWebVoipInit;yield t.initWAWebVoip()}}));s(function(){e()},[e]),o("useWAWebListener").useListener(o("WAWebCmd").Cmd,"on_ab_props_update_from_bridge",e);var t=r("useWAWebEventTargetValue")(o("WAWebVoipInit").VoipInitEventEmitter,"voipInitSuccess",function(){return o("WAWebVoipInit").VoipInitEventEmitter.getIsVoipInited()});return o("WAWebVoipGatingUtils").isCallingEnabled()&&t}l.useWAWebVoipIsCallingEnabledAndInited=u}),98);
__d("WAWebCallButtons.react",["fbt","$InternalEnum","WALogger","WANullthrows","WAWebActionMenuItem.react","WAWebAddUserIcon.react","WAWebButton.react","WAWebCallButtonsSurface","WAWebCallCollection","WAWebCallLogUtils","WAWebChatGetters","WAWebChatsOutlineIcon.react","WAWebContactCollection","WAWebDesktopUpsellCallingUnavailablePopover.react","WAWebDesktopUpsellUtils","WAWebDrawerManager","WAWebDropdownV2.react","WAWebEnvironment","WAWebFrontendContactGetters","WAWebGroupCallParticipantSelector.react","WAWebGroupMetadataCollection","WAWebLidMigrationUtils","WAWebMenuBar.react","WAWebMenuBarStyles","WAWebMobilePlatforms","WAWebModalManager","WAWebMsgGetters","WAWebNux","WAWebPopoverContext.react","WAWebPreCallUserJourneyLogger","WAWebScreenWidthThresholds","WAWebSettingsConst","WAWebSettingsFlowLoadable","WAWebSingleCallDropdownContent.react","WAWebTabOrder","WAWebUnstyledButton.react","WAWebUserPrefsMeUser","WAWebVideoCallRefreshedIcon.react","WAWebVoipActionRequestOpenChat","WAWebVoipBetaCallingUpsellPopover.react","WAWebVoipCallingNux.react","WAWebVoipCoexCallingPermissionDisabledModal.react","WAWebVoipGatingUtils","WAWebVoipOngoingCallCollection","WAWebVoipStackInterface","WAWebVoipStartCall","WAWebWamEnumLobbyEntryPointType","WAWebWamEnumSubSurface","WDSButton.react","WDSIconIcArrowDropDown.react","WDSIconIcCall.react","WDSIconIcVideocam.react","WDSMenuBarItem.react","WDSText.react","asyncToGeneratorRuntime","fbs","isStringNullOrEmpty","nullthrows","react","stylex","useWAWebABPropConfigValue","useWAWebEventTargetValue","useWAWebExternalBetaOptIn","useWAWebIsWinHybridJoinableCallsEnabled","useWAWebMsgValues","useWAWebVoipCanStartCall","useWAWebVoipIsCallingEnabledAndInited","useWAWebWindowSize"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R=S||(S=o("react")),L=b||(b=r("react")),E=R.useMemo,k=R.useRef,I=R.useState,T=n("$InternalEnum").Mirrored(["NONE","BETA","DESKTOP"]),D={callDropdownShadow:{boxShadow:"xs2e80n",$$css:!0},callButtonIcon:{color:"x14ug900",height:"x1qx5ct2",width:"xw4jnvo",$$css:!0},customCallButton:{alignItems:"x6s0dn4",backgroundColor:"x1280gxy x1ubxc9n",borderTopColor:"xnj1f2r",borderInlineEndColor:"x2uibgs",borderBottomColor:"xkveyfu",borderInlineStartColor:"x12llq9",borderStartStartRadius:"xt8t1vi",borderStartEndRadius:"x1xc408v",borderEndEndRadius:"x129tdwq",borderEndStartRadius:"x15urzxu",borderTopStyle:"x13fuv20",borderInlineEndStyle:"x18b5jzi",borderBottomStyle:"x1q0q8m5",borderInlineStartStyle:"x1t7ytsu",borderTopWidth:"x178xt8z",borderInlineEndWidth:"x1lun4ml",borderBottomWidth:"xso031l",borderInlineStartWidth:"xpilrb4",columnGap:"x1s70e7g",cursor:"x1ypdohk x1s07b3s",display:"x78zum5",minHeight:"x1ba4aug",opacity:"x1hc1fzr x1lfpgzf",paddingTop:"x16ovd2e",paddingBottom:"x12xbjc7",paddingInlineStart:"xdx6fka",paddingInlineEnd:"xvtqlqk",paddingLeft:null,paddingRight:null,$$css:!0},buttonMargin:{marginInlineStart:"x150mmf0",$$css:!0},unifiedButtonMargin:{marginInlineStart:"x150mmf0",marginInlineEnd:"xqf2s3x",$$css:!0}};function x(t){var a,i,l=t.callFromUI,b=l===void 0?0:l,S=t.callLinkCode,R=S===void 0?"":S,x=t.chat,$=t.isCallLinkVideo,P=$===void 0?!1:$,N=t.lobbyEntryPoint,M=N===void 0?0:N,w=t.participants,A=t.surface,F=o("useWAWebVoipIsCallingEnabledAndInited").useWAWebVoipIsCallingEnabledAndInited(),O=o("useWAWebIsWinHybridJoinableCallsEnabled").useIsWinHybridJoinableCallsEnabled(),B=o("useWAWebABPropConfigValue").useABPropConfigValue("enable_lid_call_link"),W=o("useWAWebABPropConfigValue").useABPropConfigValue("add_to_call_in_chat_thread")>0,q=r("useWAWebEventTargetValue")(o("WAWebVoipOngoingCallCollection").WAWebVoipOngoingCallCollection,"all",function(){return o("WAWebVoipOngoingCallCollection").WAWebVoipOngoingCallCollection.getByChat(x)}),U=o("useWAWebMsgValues").useOptionalMsgValues((a=q==null?void 0:q.id)!=null?a:null,[o("WAWebMsgGetters").getCallParticipants]),V=(i=U==null?void 0:U[0])!=null?i:null,H=o("WAWebChatGetters").getIsGroup(x),G=!o("useWAWebVoipCanStartCall").useWAWebVoipCanStartCall(x),z=o("useWAWebVoipCanStartCall").useWAWebVoipIsCapiCallingPermissionAllowed(x),j=k(null),K=k(null),Q=k(null),X=o("WAWebPopoverContext.react").useWAWebPopoverControllerRef(),Y=o("WAWebPopoverContext.react").useWAWebPopoverControllerRef(),J=o("WAWebPopoverContext.react").useWAWebPopoverControllerRef(),Z=k(!1),ee=I(!1),te=ee[0],ne=ee[1],re=E(function(){return new(o("WAWebPreCallUserJourneyLogger")).PreCallUserJourneyLogger},[]),oe=o("useWAWebABPropConfigValue").useABPropConfigValue("wds_web_button"),ae=o("WAWebVoipGatingUtils").isGroupCallingEnabled(),ie=o("useWAWebABPropConfigValue").useABPropConfigValue("enable_web_calling_nux")&&!r("WAWebEnvironment").isWindows,le=o("useWAWebABPropConfigValue").useABPropConfigValue("enable_web_calling_beta_upsell"),se=o("useWAWebABPropConfigValue").useABPropConfigValue("group_call_max_participants"),ue=r("useWAWebWindowSize")(),ce=ue.width<o("WAWebScreenWidthThresholds").NARROW_SCREEN_THRESHOLD,de=o("useWAWebABPropConfigValue").useABPropConfigValue("enable_unified_call_buttons_in_chat")&&A!==o("WAWebCallButtonsSurface").WAWebCallButtonsSurface.CallLogDetails&&A!==o("WAWebCallButtonsSurface").WAWebCallButtonsSurface.IconOnly,me=o("useWAWebABPropConfigValue").useABPropConfigValue("unified_calling_entry_point_desktop_type"),pe=r("useWAWebEventTargetValue")(r("WAWebCallCollection"),"change:activeCall",function(){return r("WAWebCallCollection").activeCall}),_e=function(){if(q==null||pe==null)return!1;var e=pe.id,t=o("WAWebMsgGetters").getCallId(q);return e===t},fe=function(){return q==null||_e()?!1:o("WAWebCallLogUtils").getIsSelfConnected(V)},ge=function(){var e=o("WAWebCallLogUtils").getJoinButtonTextType(_e(),fe());return e==="return"?r("fbs")._(/*BTDS*/"Return"):e==="join_here"?r("fbs")._(/*BTDS*/"Join here"):e==="join"?r("fbs")._(/*BTDS*/"Join"):(function(){throw Error("Match: No case succesfully matched. Make exhaustive or add a wildcard case using '_'. Argument: "+e)})()},he=o("useWAWebExternalBetaOptIn").useExternalBetaOptIn(),ye=he[0],Ce=o("WAWebDesktopUpsellUtils").getUserDesktopOs(),be=T.NONE;if(r("WAWebEnvironment").isWeb){if(!F&&o("WAWebVoipGatingUtils").isCallingEnabled())return null;if(H){var ve,Se,Re,Le=r("WAWebGroupMetadataCollection").get(x.id.toString()),Ee=(ve=(Se=Le==null?void 0:Le.size)!=null?Se:Le==null||(Re=Le.participants)==null?void 0:Re.length)!=null?ve:0;if(Ee>se)return null;if(!o("WAWebVoipGatingUtils").isGroupCallingEnabled())if(Ce!=null)be=T.DESKTOP;else return null}else if(!o("WAWebVoipGatingUtils").isCallingEnabled())if(!ye&&le)be=T.BETA;else if(Ce!=null)be=T.DESKTOP;else return null}var ke=be!==T.NONE,Ie=H?s._(/*BTDS*/"Group voice call"):s._(/*BTDS*/"Voice call"),Te=H?s._(/*BTDS*/"Group video call"):s._(/*BTDS*/"Video call"),De=function(n){if(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["voip: header: start call, isVideo: ",", groupType: ",""])),n,x.groupType),!z){o("WAWebModalManager").ModalManager.open(L.jsx(r("WAWebVoipCoexCallingPermissionDisabledModal.react"),{}));return}w!=null&&w.length>1?(o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["voip: header: starting ad hoc group call"]))),o("WAWebVoipStartCall").startWAWebVoipGroupCallFromWids(w,n,b,M)):x.groupType===void 0?(o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["voip: header: starting 1:1 call"]))),o("WAWebVoipStartCall").startWAWebVoipCall(x.contact.id,n,b,M)):(o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["voip: header: starting group call"]))),o("WAWebVoipStartCall").startWAWebVoipGroupCallFromChat(x,n,b,M))},xe=function(t){var e,n=t?X:Y;(e=n.current)==null||e.hidePopover()};if(O&&q!=null&&!o("WAWebMsgGetters").getIsCallLink(q)&&x.id.isGroup())return L.jsx("div",babelHelpers.extends({},(v||(v=r("stylex"))).props(r("WAWebMenuBarStyles").itemButton,D.buttonMargin),{children:L.jsxs(o("WAWebButton.react").WAWebButtonPrimaryCompact,{onClick:function(){o("WAWebVoipStartCall").joinOngoingWAWebVoipGroupCallPN(r("nullthrows")(o("WAWebMsgGetters").getCallId(q)),x,o("WAWebMsgGetters").getIsVideoCall(q),A===o("WAWebCallButtonsSurface").WAWebCallButtonsSurface.CallLogDetails?o("WAWebWamEnumLobbyEntryPointType").LOBBY_ENTRY_POINT_TYPE.CALL_LOG:o("WAWebWamEnumLobbyEntryPointType").LOBBY_ENTRY_POINT_TYPE.CHAT_HEADER)},children:[q.isVideoCall?L.jsx(o("WAWebVideoCallRefreshedIcon.react").VideoCallRefreshedIcon,{}):L.jsx(r("WDSIconIcCall.react"),{}),ge()]})}));if(A===o("WAWebCallButtonsSurface").WAWebCallButtonsSurface.CallLogDetails&&!r("isStringNullOrEmpty")(R))return L.jsx("div",babelHelpers.extends({},(v||(v=r("stylex"))).props(r("WAWebMenuBarStyles").itemButton,D.buttonMargin),{children:L.jsxs(o("WAWebButton.react").WAWebButtonPrimaryCompact,{onClick:n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["voip: preview call link: CallLinkCode=",", isVideo=",""])),R,P);try{var e=yield o("WAWebVoipStackInterface").getVoipStackInterface();if(R){var t=o("WAWebContactCollection").ContactCollection.getMeContact(),n=t?o("WAWebFrontendContactGetters").getUsername(t):null;yield e==null?void 0:e.previewCallLink(R,P!=null?P:!1,B,o("WAWebWamEnumLobbyEntryPointType").LOBBY_ENTRY_POINT_TYPE.CALL_LINK_CALL_LOG,n),o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["voip: preview call link initiated successfully"])))}else o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["voip: preview call link failed - CallLinkCode is empty"])))}catch(e){o("WALogger").ERROR(f||(f=babelHelpers.taggedTemplateLiteralLoose(["voip: preview call link failed with error: ",""])),String(e))}}),children:[P?L.jsx(o("WAWebVideoCallRefreshedIcon.react").VideoCallRefreshedIcon,{}):L.jsx(r("WDSIconIcCall.react"),{}),r("fbs")._(/*BTDS*/"Join")]})}));var $e=function(t){var e=t?L.jsx(o("WAWebVideoCallRefreshedIcon.react").VideoCallRefreshedIcon,{}):L.jsx(r("WDSIconIcCall.react"),{}),n=t?Te:Ie,a=t?j:K,i=t?X:Y;return oe?L.jsxs(L.Fragment,{children:[L.jsx(r("WDSMenuBarItem.react"),{ref:a,tabOrder:o("WAWebTabOrder").TAB_ORDER.CHAT_HEADER_BUTTON,testid:void 0,title:n,icon:t?o("WAWebVideoCallRefreshedIcon.react").VideoCallRefreshedIcon:r("WDSIconIcCall.react"),disabled:G,marginInlineXstyle:D.buttonMargin}),L.jsx(o("WAWebDropdownV2.react").DropdownV2Menu,{xstyle:D.callDropdownShadow,controllerRef:i,position:o("WAWebDropdownV2.react").PopoverPosition.Bottom,alignment:o("WAWebDropdownV2.react").PopoverAlignment.End,target:a,maxHeight:488,onClose:function(){Z.current||re.dismissChatThread(o("WAWebWamEnumSubSurface").SUB_SURFACE.ADD_PARTICIPANT_PICKER),Z.current=!1},children:L.jsx(r("WAWebGroupCallParticipantSelector.react"),{chat:x,icon:e,isCallingDisabled:G,isVideo:t,logger:re,onActionTaken:function(){Z.current=!0},onCallStart:xe,useUnifiedUI:!1},x.id.toString())})]}):L.jsxs(L.Fragment,{children:[L.jsx(o("WAWebMenuBar.react").MenuBarItem,{ref:a,tabOrder:o("WAWebTabOrder").TAB_ORDER.CHAT_HEADER_BUTTON,testid:void 0,icon:e,disabled:G,title:n}),L.jsx(o("WAWebDropdownV2.react").DropdownV2Menu,{xstyle:D.callDropdownShadow,controllerRef:i,position:o("WAWebDropdownV2.react").PopoverPosition.Bottom,alignment:o("WAWebDropdownV2.react").PopoverAlignment.End,target:a,maxHeight:488,onClose:function(){Z.current||re.dismissChatThread(o("WAWebWamEnumSubSurface").SUB_SURFACE.ADD_PARTICIPANT_PICKER),Z.current=!1},children:L.jsx(r("WAWebGroupCallParticipantSelector.react"),{chat:x,icon:e,isCallingDisabled:G,isVideo:t,logger:re,onActionTaken:function(){Z.current=!0},onCallStart:xe},x.id.toString())})]})},Pe=function(){return be===T.BETA?L.jsx(r("WAWebVoipBetaCallingUpsellPopover.react"),{onClick:function(){var e,t,n;(e=X.current)==null||e.hidePopover(),(t=Y.current)==null||t.hidePopover(),(n=J.current)==null||n.hidePopover(),o("WAWebDrawerManager").DrawerManager.openDrawerLeft(L.jsx(o("WAWebSettingsFlowLoadable").SettingsFlowLoadable,{onEnd:o("WAWebDrawerManager").closeDrawerLeft,initialStep:o("WAWebSettingsConst").SettingsSteps.Help}))}}):be===T.DESKTOP?L.jsx(r("WAWebDesktopUpsellCallingUnavailablePopover.react"),{userDesktopOs:r("WANullthrows")(Ce),isGroupCall:H}):null},Ne=function(){if(ke){var e=Pe();return L.jsxs(L.Fragment,{children:[L.jsxs(r("WAWebUnstyledButton.react"),{ref:j,xstyle:[D.customCallButton,D.unifiedButtonMargin],dataTab:o("WAWebTabOrder").TAB_ORDER.CHAT_HEADER_BUTTON,"aria-label":Te,"aria-haspopup":"menu","aria-expanded":te,children:[L.jsx(r("WDSIconIcVideocam.react"),{iconXstyle:D.callButtonIcon}),L.jsx(r("WDSText.react"),{type:"Body2Emphasized",textAlign:"center",selectable:!1,colorName:"contentDefault",children:s._(/*BTDS*/"Call")}),L.jsx(r("WDSIconIcArrowDropDown.react"),{iconXstyle:D.callButtonIcon})]}),L.jsx(o("WAWebDropdownV2.react").DropdownV2Menu,{xstyle:D.callDropdownShadow,controllerRef:X,position:o("WAWebDropdownV2.react").PopoverPosition.Bottom,alignment:o("WAWebDropdownV2.react").PopoverAlignment.End,target:j,maxHeight:488,children:e})]})}var t=L.jsx(o("WAWebDropdownV2.react").DropdownV2Menu,{xstyle:D.callDropdownShadow,controllerRef:X,position:o("WAWebDropdownV2.react").PopoverPosition.Bottom,alignment:o("WAWebDropdownV2.react").PopoverAlignment.End,target:j,maxHeight:488,onOpen:function(){ne(!0)},onClose:function(){ne(!1),Z.current||re.dismissChatThread(o("WAWebWamEnumSubSurface").SUB_SURFACE.ADD_PARTICIPANT_PICKER),Z.current=!1},children:L.jsx(r("WAWebGroupCallParticipantSelector.react"),{chat:x,icon:L.jsx(o("WAWebVideoCallRefreshedIcon.react").VideoCallRefreshedIcon,{}),isCallingDisabled:G,isVideo:!0,logger:re,onActionTaken:function(){Z.current=!0},onCallStart:xe,useUnifiedUI:!0},x.id.toString())});return me===0?L.jsxs(L.Fragment,{children:[L.jsxs(r("WAWebUnstyledButton.react"),{ref:j,xstyle:[D.customCallButton,D.unifiedButtonMargin],disabled:G,dataTab:o("WAWebTabOrder").TAB_ORDER.CHAT_HEADER_BUTTON,"aria-label":Te,children:[L.jsx(r("WDSIconIcVideocam.react"),{iconXstyle:D.callButtonIcon}),L.jsx(r("WDSText.react"),{type:"Body2Emphasized",textAlign:"center",selectable:!1,colorName:"contentDefault",children:s._(/*BTDS*/"Call")}),L.jsx(r("WDSIconIcArrowDropDown.react"),{iconXstyle:D.callButtonIcon})]}),t]}):L.jsxs(L.Fragment,{children:[L.jsx(r("WDSButton.react"),{variant:"borderless",size:"medium",type:"default",ref:j,Icon:r("WDSIconIcVideocam.react"),showEndDropdownIcon:!0,disabled:G,onPress:function(){var e;re.clickCallDropdown(o("WAWebWamEnumSubSurface").SUB_SURFACE.CHAT_HEADER),(e=X.current)==null||e.showPopover()},"aria-label":Te}),t]})},Me=function(){if(pe==null)return!1;if(H&&pe.isGroup){var e,t;return(e=(t=pe.groupJid)==null?void 0:t.equals(x.id))!=null?e:!1}if(!H&&pe.groupCallParticipants!=null)return pe.groupCallParticipants.some(function(e){var t,n=o("WAWebLidMigrationUtils").toCommonAddressingMode(e,x.id),r=n[0],a=n[1];return(t=r==null?void 0:r.equals(a))!=null?t:!1});if(!H&&!pe.isGroup){var n,r=o("WAWebLidMigrationUtils").toCommonAddressingMode(pe.peerJid,x.id),a=r[0],i=r[1];return(n=a==null?void 0:a.equals(i))!=null?n:!1}return!1},we=ce||o("WAWebMobilePlatforms").isSMB(),Ae=function(){if(ke){var e=Pe();return L.jsxs(L.Fragment,{children:[L.jsxs(r("WAWebUnstyledButton.react"),{testid:void 0,ref:Q,xstyle:[D.customCallButton,D.unifiedButtonMargin],dataTab:o("WAWebTabOrder").TAB_ORDER.CHAT_HEADER_BUTTON,"aria-label":Te,role:"button",children:[L.jsx(r("WDSIconIcVideocam.react"),{iconXstyle:D.callButtonIcon}),!we&&L.jsx(r("WDSText.react"),{type:"Body2Emphasized",textAlign:"center",selectable:!1,colorName:"contentDefault",children:s._(/*BTDS*/"Call")}),L.jsx(r("WDSIconIcArrowDropDown.react"),{iconXstyle:D.callButtonIcon})]}),L.jsx(o("WAWebDropdownV2.react").DropdownV2Menu,{xstyle:D.callDropdownShadow,controllerRef:J,position:o("WAWebDropdownV2.react").PopoverPosition.Bottom,alignment:o("WAWebDropdownV2.react").PopoverAlignment.End,target:Q,maxHeight:488,children:e})]})}return L.jsxs(L.Fragment,{children:[L.jsxs(r("WAWebUnstyledButton.react"),{testid:void 0,ref:Q,xstyle:[D.customCallButton,D.unifiedButtonMargin],disabled:G,dataTab:o("WAWebTabOrder").TAB_ORDER.CHAT_HEADER_BUTTON,"aria-label":Te,role:"button",children:[L.jsx(r("WDSIconIcVideocam.react"),{iconXstyle:D.callButtonIcon}),!we&&L.jsx(r("WDSText.react"),{type:"Body2Emphasized",textAlign:"center",selectable:!1,colorName:"contentDefault",children:s._(/*BTDS*/"Call")}),L.jsx(r("WDSIconIcArrowDropDown.react"),{iconXstyle:D.callButtonIcon})]}),L.jsx(o("WAWebDropdownV2.react").DropdownV2Menu,{xstyle:D.callDropdownShadow,controllerRef:J,position:o("WAWebDropdownV2.react").PopoverPosition.Bottom,alignment:o("WAWebDropdownV2.react").PopoverAlignment.End,target:Q,maxHeight:488,onClose:function(){Z.current||re.dismissChatThread(o("WAWebWamEnumSubSurface").SUB_SURFACE.CALL_DROPDOWN_MENU),Z.current=!1},children:L.jsx(r("WAWebSingleCallDropdownContent.react"),{chat:x,handleCall:De,isCallingDisabled:G,logger:re,onActionTaken:function(){Z.current=!0},onClose:function(){var e;return(e=J.current)==null?void 0:e.hidePopover()},enableWebGroupCalling:ae})})]})},Fe=function(t){if(!W||pe==null)return!1;var e=Me();return e?!1:pe.isGroup&&pe.groupJid==null?!0:pe.isGroup?!1:t&&pe.isVideo||!t&&!pe.isVideo},Oe=function(t){if(t?re.clickVideoCall(o("WAWebWamEnumSubSurface").SUB_SURFACE.CHAT_HEADER):re.clickAudioCall(o("WAWebWamEnumSubSurface").SUB_SURFACE.CHAT_HEADER),Fe(t)){var e,n=t?X:Y;(e=n.current)==null||e.showPopover()}else De(t)},Be=function(){if(de&&me===0)return Ae();var e=G,t=G;if(W){var a=Me();a?(e=!0,t=!0):pe!=null&&(pe.isGroup&&pe.groupJid!=null?(e=!0,t=!0):(e=!pe.isVideo,t=pe.isVideo))}var i=oe?L.jsx(r("WDSMenuBarItem.react"),{ref:j,tabOrder:o("WAWebTabOrder").TAB_ORDER.CHAT_HEADER_BUTTON,testid:void 0,icon:o("WAWebVideoCallRefreshedIcon.react").VideoCallRefreshedIcon,onClick:function(){return Oe(!0)},disabled:e,title:Te,marginInlineXstyle:D.buttonMargin}):L.jsx(o("WAWebMenuBar.react").MenuBarItem,{ref:j,tabOrder:o("WAWebTabOrder").TAB_ORDER.CHAT_HEADER_BUTTON,testid:void 0,icon:L.jsx(o("WAWebVideoCallRefreshedIcon.react").VideoCallRefreshedIcon,{}),onClick:function(){return Oe(!0)},disabled:e,title:Te}),l=oe?L.jsx(r("WDSMenuBarItem.react"),{ref:K,tabOrder:o("WAWebTabOrder").TAB_ORDER.CHAT_HEADER_BUTTON,testid:void 0,icon:r("WDSIconIcCall.react"),onClick:function(){return Oe(!1)},disabled:t,title:Ie,marginInlineXstyle:D.buttonMargin}):L.jsx(o("WAWebMenuBar.react").MenuBarItem,{ref:K,tabOrder:o("WAWebTabOrder").TAB_ORDER.CHAT_HEADER_BUTTON,testid:void 0,icon:L.jsx(r("WDSIconIcCall.react"),{}),onClick:function(){return Oe(!1)},disabled:t,title:Ie}),u=Fe(!0)?L.jsx(o("WAWebDropdownV2.react").DropdownV2Menu,{xstyle:D.callDropdownShadow,controllerRef:X,position:o("WAWebDropdownV2.react").PopoverPosition.Bottom,alignment:o("WAWebDropdownV2.react").PopoverAlignment.End,target:j,maxHeight:488,children:L.jsx(o("WAWebActionMenuItem.react").ActionMenuItem,{optionId:"add-to-call-video",detailLeft:L.jsx(o("WAWebAddUserIcon.react").AddUserIcon,{}),primary:s._(/*BTDS*/"Add to call"),onSelect:n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e;o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["voip: add to call clicked for video call with chat: ",""])),x.id.toString());try{yield o("WAWebVoipStartCall").inviteToCall(x.id)}catch(e){o("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["voip: add to call failed for ",": ",""])),x.id.toString(),String(e))}(e=X.current)==null||e.hidePopover()})})}):null,c=Fe(!1)?L.jsx(o("WAWebDropdownV2.react").DropdownV2Menu,{xstyle:D.callDropdownShadow,controllerRef:Y,position:o("WAWebDropdownV2.react").PopoverPosition.Bottom,alignment:o("WAWebDropdownV2.react").PopoverAlignment.End,target:K,maxHeight:488,children:L.jsx(o("WAWebActionMenuItem.react").ActionMenuItem,{optionId:"add-to-call-voice",detailLeft:L.jsx(o("WAWebAddUserIcon.react").AddUserIcon,{}),primary:s._(/*BTDS*/"Add to call"),onSelect:n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e;o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["voip: add to call clicked for voice call with chat: ",""])),x.id.toString());try{yield o("WAWebVoipStartCall").inviteToCall(x.id)}catch(e){o("WALogger").ERROR(C||(C=babelHelpers.taggedTemplateLiteralLoose(["voip: add to call failed for ",": ",""])),x.id.toString(),String(e))}(e=Y.current)==null||e.hidePopover()})})}):null;return L.jsxs(L.Fragment,{children:[i,u,l,c]})},We=function(){if(x.id.isGroup())return!0;if(w==null)return!1;var e=w.filter(function(e){return!o("WAWebUserPrefsMeUser").isMeAccount(e)});return e.length<=1},qe=Be();return L.jsxs(L.Fragment,{children:[A===o("WAWebCallButtonsSurface").WAWebCallButtonsSurface.CallLogDetails&&We()&&oe&&L.jsx(r("WDSMenuBarItem.react"),{tabOrder:o("WAWebTabOrder").TAB_ORDER.CHAT_HEADER_BUTTON,testid:void 0,icon:o("WAWebChatsOutlineIcon.react").ChatsOutlineIcon,onClick:function(){return o("WAWebVoipActionRequestOpenChat").requestOpenChat(x.id)},title:r("fbs")._(/*BTDS*/"Messages"),marginInlineXstyle:D.buttonMargin}),A===o("WAWebCallButtonsSurface").WAWebCallButtonsSurface.CallLogDetails&&We()&&!oe&&L.jsx(o("WAWebMenuBar.react").MenuBarItem,{tabOrder:o("WAWebTabOrder").TAB_ORDER.CHAT_HEADER_BUTTON,testid:void 0,icon:L.jsx(o("WAWebChatsOutlineIcon.react").ChatsOutlineIcon,{}),onClick:function(){return o("WAWebVoipActionRequestOpenChat").requestOpenChat(x.id)},title:r("fbs")._(/*BTDS*/"Messages")}),H&&de&&Ne(),H&&de&&me===1&&L.jsx("div",{className:"xamitd3 x3x0x6p xxk0z11 x1i1rx1s"}),H&&!de&&L.jsxs(L.Fragment,{children:[$e(!0),$e(!1)]}),!H&&qe,!H&&ie&&o("WAWebVoipGatingUtils").isCallingEnabled()&&L.jsx(r("WAWebVoipCallingNux.react"),{targetRef:Q,nuxKey:o("WAWebNux").NUX.WEB_CALLING_1_1_NUX}),H&&de&&ie&&o("WAWebVoipGatingUtils").isGroupCallingEnabled()&&L.jsx(r("WAWebVoipCallingNux.react"),{targetRef:j,nuxKey:o("WAWebNux").NUX.WEB_CALLING_GROUP_NUX})]})}x.displayName=x.name+" [from "+i.id+"]",l.WAWebCallButtons=x}),226);
__d("WAWebOrchestratorJobEventSampling",[],(function(t,n,r,o,a,i){var e={sendMessage:10,createLidPnMappings:10,updateLidMetadata:10,getAllUserDisclosures:10,handleBusinessNotification:5,syncMyDeviceList:5,receiptBatcherRunActiveBatches:5,updateDraftMessageChat:5},l={JOB_EVENT_SAMPLING_RATE:e};i.default=l}),66);